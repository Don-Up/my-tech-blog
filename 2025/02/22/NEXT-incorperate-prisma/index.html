<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="Why Prisma, PostgreSQL, and Next.js?
Prisma: A modern ORM that simplifies database interactions with type-safe queries.
PostgreSQL: A powerful, open-s"/>
    

    <!--Author-->
    
        <meta name="author" content="Don Ye"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="How to Integrate Prisma (PostgreSQL) into an Next.js Project"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Why Prisma, PostgreSQL, and Next.js?
Prisma: A modern ORM that simplifies database interactions with type-safe queries.
PostgreSQL: A powerful, open-s"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="Tech Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="https://don-up.github.io/my-tech-blogimg/home-bg1.png"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="https://don-up.github.io/my-tech-blogimg/home-bg1.png"/>
    

    <!-- Title -->
    
    <title>How to Integrate Prisma (PostgreSQL) into an Next.js Project - Tech Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/my-tech-blog/css/style.css">


    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    


    <!-- favicon -->
    

<meta name="generator" content="Hexo 7.3.0"></head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/my-tech-blog/">Tech Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/my-tech-blog/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/my-tech-blog/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/my-tech-blog/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/my-tech-blog/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener" href="https://github.com/Don-Up">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/my-tech-blog/img/home-bg1.png')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>How to Integrate Prisma (PostgreSQL) into an Next.js Project</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2025-02-22
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h2 id="Why-Prisma-PostgreSQL-and-Next-js"><a href="#Why-Prisma-PostgreSQL-and-Next-js" class="headerlink" title="Why Prisma, PostgreSQL, and Next.js?"></a>Why Prisma, PostgreSQL, and Next.js?</h2><ul>
<li><strong>Prisma</strong>: A modern ORM that simplifies database interactions with type-safe queries.</li>
<li><strong>PostgreSQL</strong>: A powerful, open-source relational database that’s reliable and scalable.</li>
<li><strong>Next.js</strong>: A full-stack framework that makes it easy to build both frontend and backend logic.</li>
</ul>
<p>Together, they form a killer stack for building data-driven web apps.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>Before we start, make sure you have:</p>
<ul>
<li>An existing Next.js project (we’ll assume it’s already set up).</li>
<li>Node.js installed on your machine.</li>
<li>PostgreSQL installed locally or a hosted instance (e.g., Supabase, Railway).</li>
<li>Basic familiarity with Next.js, Node.js, and databases.</li>
</ul>
<p>Let’s get rolling!</p>
<hr>
<h2 id="Step-1-Install-and-Set-Up-Prisma"><a href="#Step-1-Install-and-Set-Up-Prisma" class="headerlink" title="Step 1: Install and Set Up Prisma"></a>Step 1: Install and Set Up Prisma</h2><p>First, we need to add Prisma to your Next.js project.</p>
<h3 id="Install-Prisma-CLI-and-Client"><a href="#Install-Prisma-CLI-and-Client" class="headerlink" title="Install Prisma CLI and Client:"></a>Install Prisma CLI and Client:</h3><p>Open your terminal in the project root and run:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install prisma --save-dev</span><br><span class="line">npm install @prisma/client</span><br></pre></td></tr></table></figure>

<h3 id="Initialize-Prisma"><a href="#Initialize-Prisma" class="headerlink" title="Initialize Prisma:"></a>Initialize Prisma:</h3><p>Run this command to set up Prisma:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx prisma init</span><br></pre></td></tr></table></figure>

<p>This creates:</p>
<ul>
<li>A <code>prisma</code> folder with <code>schema.prisma</code>.</li>
<li>A <code>.env</code> file for environment variables.</li>
</ul>
<hr>
<h2 id="Step-2-Configure-PostgreSQL-Connection"><a href="#Step-2-Configure-PostgreSQL-Connection" class="headerlink" title="Step 2: Configure PostgreSQL Connection"></a>Step 2: Configure PostgreSQL Connection</h2><p>Next, connect Prisma to your PostgreSQL database.</p>
<h3 id="Set-Up-PostgreSQL"><a href="#Set-Up-PostgreSQL" class="headerlink" title="Set Up PostgreSQL:"></a>Set Up PostgreSQL:</h3><ul>
<li>If using a local instance, ensure PostgreSQL is running (e.g., via pgAdmin or the terminal).</li>
<li>If using a hosted service, grab the connection URL from your provider.</li>
</ul>
<h3 id="Update-env"><a href="#Update-env" class="headerlink" title="Update .env:"></a>Update <code>.env</code>:</h3><p>Open <code>.env</code> and add your database connection string. For a local setup, it might look like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DATABASE_URL=&quot;postgresql://postgres:123456@localhost:5432/mydb&quot;</span><br></pre></td></tr></table></figure>

<p>Replace <code>postgres</code>, <code>123456</code>, <code>localhost</code>, <code>5432</code>, and <code>mydb</code> with your actual PostgreSQL username, password, host, port, and database name.</p>
<hr>
<h2 id="Step-3-Define-the-Event-Model"><a href="#Step-3-Define-the-Event-Model" class="headerlink" title="Step 3: Define the Event Model"></a>Step 3: Define the Event Model</h2><p>Now, let’s define the database schema. Open <code>prisma/schema.prisma</code> and update it with the Event model:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">generator client &#123;</span><br><span class="line">  provider = &quot;prisma-client-js&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">datasource db &#123;</span><br><span class="line">  provider = &quot;postgresql&quot;</span><br><span class="line">  url      = env(&quot;DATABASE_URL&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">model Event &#123;</span><br><span class="line">  id          String   @id @default(cuid())</span><br><span class="line">  title       String</span><br><span class="line">  description String</span><br><span class="line">  location    String</span><br><span class="line">  date        DateTime</span><br><span class="line">  image       String</span><br><span class="line">  isFeatured  Boolean</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>@id @default(cuid())</code>: Generates a unique ID for each event.</li>
<li><strong>Fields</strong>: Represent event details like title, description, and date.</li>
</ul>
<hr>
<h2 id="Step-4-Generate-Prisma-Client"><a href="#Step-4-Generate-Prisma-Client" class="headerlink" title="Step 4: Generate Prisma Client"></a>Step 4: Generate Prisma Client</h2><p>With the schema defined, let’s sync it with the database and generate the Prisma Client:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx prisma migrate dev --name init</span><br></pre></td></tr></table></figure>

<p>This command:</p>
<ul>
<li>Creates the Event table in your PostgreSQL database.</li>
<li>Generates the Prisma Client in <code>node_modules/@prisma/client</code>.</li>
</ul>
<p>or:</p>
<h4 id="Step-1-Create-a-Migration"><a href="#Step-1-Create-a-Migration" class="headerlink" title="Step 1: Create a Migration"></a>Step 1: Create a Migration</h4><p>Run the following command to create a migration:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx prisma migrate dev --name add_event_model</span><br></pre></td></tr></table></figure>


<p>This command will create a new migration file in the <code>prisma/migrations</code> directory and apply it to your database.</p>
<h4 id="Step-2-Apply-the-Migration"><a href="#Step-2-Apply-the-Migration" class="headerlink" title="Step 2: Apply the Migration"></a>Step 2: Apply the Migration</h4><p>If you have already created the migration, you can apply it using:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx prisma migrate dev</span><br></pre></td></tr></table></figure>


<p>This command will apply the migration to your database and update the Prisma Client.</p>
<h4 id="Additional-Step-Generate-Prisma-Client"><a href="#Additional-Step-Generate-Prisma-Client" class="headerlink" title="Additional Step: Generate Prisma Client"></a>Additional Step: Generate Prisma Client</h4><p>After applying the migration, you should generate the Prisma Client to reflect the changes:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx prisma generate</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Step-5-Set-Up-Prisma-Client"><a href="#Step-5-Set-Up-Prisma-Client" class="headerlink" title="Step 5: Set Up Prisma Client"></a>Step 5: Set Up Prisma Client</h2><p>To use Prisma in your app, create a reusable Prisma Client instance.</p>
<p>Create <code>lib/prisma.js</code> (or <code>lib/prisma.ts</code> if using TypeScript):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PrismaClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@prisma/client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> prisma = <span class="keyword">new</span> <span class="title class_">PrismaClient</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> prisma;</span><br></pre></td></tr></table></figure>

<p>This ensures a single Prisma Client instance is used across your project.</p>
<hr>
<h2 id="Step-6-Insert-Initial-Data"><a href="#Step-6-Insert-Initial-Data" class="headerlink" title="Step 6: Insert Initial Data"></a>Step 6: Insert Initial Data</h2><p>Let’s populate the database with some sample events. Create <code>lib/initData.js</code> with the following code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">PrismaClient</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;@prisma/client&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> prisma = <span class="keyword">new</span> <span class="title class_">PrismaClient</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> eventData = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;e1&#x27;</span>,</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;Programming for everyone&#x27;</span>,</span><br><span class="line">    <span class="attr">description</span>:</span><br><span class="line">      <span class="string">&#x27;Everyone can learn to code! Yes, everyone! In this live event, we are going to go through all the key basics and get you started with programming as well.&#x27;</span>,</span><br><span class="line">    <span class="attr">location</span>: <span class="string">&#x27;Somestreet 25, 12345 San Somewhereo&#x27;</span>,</span><br><span class="line">    <span class="attr">date</span>: <span class="string">&#x27;2021-05-12&#x27;</span>,</span><br><span class="line">    <span class="attr">image</span>: <span class="string">&#x27;images/coding-event.jpg&#x27;</span>,</span><br><span class="line">    <span class="attr">isFeatured</span>: <span class="literal">false</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;e2&#x27;</span>,</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;Networking for introverts&#x27;</span>,</span><br><span class="line">    <span class="attr">description</span>:</span><br><span class="line">      <span class="string">&quot;We know: Networking is no fun if you are an introvert person. That&#x27;s why we came up with this event - it&#x27;ll be so much easier. Promised!&quot;</span>,</span><br><span class="line">    <span class="attr">location</span>: <span class="string">&#x27;New Wall Street 5, 98765 New Work&#x27;</span>,</span><br><span class="line">    <span class="attr">date</span>: <span class="string">&#x27;2021-05-30&#x27;</span>,</span><br><span class="line">    <span class="attr">image</span>: <span class="string">&#x27;images/introvert-event.jpg&#x27;</span>,</span><br><span class="line">    <span class="attr">isFeatured</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;e3&#x27;</span>,</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;Networking for extroverts&#x27;</span>,</span><br><span class="line">    <span class="attr">description</span>:</span><br><span class="line">      <span class="string">&#x27;You probably need no help with networking in general. But focusing your energy correctly - that is something where most people can improve.&#x27;</span>,</span><br><span class="line">    <span class="attr">location</span>: <span class="string">&#x27;My Street 12, 10115 Broke City&#x27;</span>,</span><br><span class="line">    <span class="attr">date</span>: <span class="string">&#x27;2022-04-10&#x27;</span>,</span><br><span class="line">    <span class="attr">image</span>: <span class="string">&#x27;images/extrovert-event.jpg&#x27;</span>,</span><br><span class="line">    <span class="attr">isFeatured</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Starting to insert events...&#x27;</span>);</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> event <span class="keyword">of</span> eventData) &#123;</span><br><span class="line">      <span class="keyword">await</span> prisma.<span class="property">event</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">          <span class="attr">id</span>: event.<span class="property">id</span>,</span><br><span class="line">          <span class="attr">title</span>: event.<span class="property">title</span>,</span><br><span class="line">          <span class="attr">description</span>: event.<span class="property">description</span>,</span><br><span class="line">          <span class="attr">location</span>: event.<span class="property">location</span>,</span><br><span class="line">          <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(event.<span class="property">date</span>),</span><br><span class="line">          <span class="attr">image</span>: event.<span class="property">image</span>,</span><br><span class="line">          <span class="attr">isFeatured</span>: event.<span class="property">isFeatured</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Inserted event: <span class="subst">$&#123;event.title&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;All events inserted successfully!&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error inserting events:&#x27;</span>, error);</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> prisma.$disconnect();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>();</span><br></pre></td></tr></table></figure>

<h3 id="Run-the-script"><a href="#Run-the-script" class="headerlink" title="Run the script:"></a>Run the script:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node lib/initData.js</span><br></pre></td></tr></table></figure>

<p>You should see logs confirming the events were inserted.</p>
<hr>
<h2 id="Step-7-Implement-CRUD-Operations"><a href="#Step-7-Implement-CRUD-Operations" class="headerlink" title="Step 7: Implement CRUD Operations"></a>Step 7: Implement CRUD Operations</h2><p>Now, let’s create an API route to handle CRUD operations for events. Create <code>src/app/api/events/route.ts</code> (or <code>pages/api/events.js</code> if using the Pages Router):</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NextRequest</span>, <span class="title class_">NextResponse</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;next/server&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> prisma <span class="keyword">from</span> <span class="string">&#x27;@/lib/prisma&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET: Fetch all events or a single event by ID</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">GET</span>(<span class="params"><span class="attr">req</span>: <span class="title class_">NextRequest</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; searchParams &#125; = <span class="keyword">new</span> <span class="title function_">URL</span>(req.<span class="property">url</span>);</span><br><span class="line">  <span class="keyword">const</span> id = searchParams.<span class="title function_">get</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (id) &#123;</span><br><span class="line">      <span class="keyword">const</span> event = <span class="keyword">await</span> prisma.<span class="property">event</span>.<span class="title function_">findUnique</span>(&#123; <span class="attr">where</span>: &#123; id &#125; &#125;);</span><br><span class="line">      <span class="keyword">if</span> (!event) <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Event not found&#x27;</span> &#125;, &#123; <span class="attr">status</span>: <span class="number">404</span> &#125;);</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(event);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> events = <span class="keyword">await</span> prisma.<span class="property">event</span>.<span class="title function_">findMany</span>(&#123; <span class="attr">orderBy</span>: &#123; <span class="attr">date</span>: <span class="string">&#x27;asc&#x27;</span> &#125; &#125;);</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(events);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error fetching events:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Internal server error&#x27;</span> &#125;, &#123; <span class="attr">status</span>: <span class="number">500</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST: Create a new event</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">POST</span>(<span class="params"><span class="attr">req</span>: <span class="title class_">NextRequest</span></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> body = <span class="keyword">await</span> req.<span class="title function_">json</span>();</span><br><span class="line">    <span class="keyword">const</span> &#123; id, title, description, location, date, image, isFeatured &#125; = body;</span><br><span class="line">    <span class="keyword">if</span> (!id || !title || !location || !date || !image) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Missing required fields&#x27;</span> &#125;, &#123; <span class="attr">status</span>: <span class="number">400</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> newEvent = <span class="keyword">await</span> prisma.<span class="property">event</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        id,</span><br><span class="line">        title,</span><br><span class="line">        description,</span><br><span class="line">        location,</span><br><span class="line">        <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(date),</span><br><span class="line">        image,</span><br><span class="line">        <span class="attr">isFeatured</span>: isFeatured ?? <span class="literal">false</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(newEvent, &#123; <span class="attr">status</span>: <span class="number">201</span> &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error creating event:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Internal server error&#x27;</span> &#125;, &#123; <span class="attr">status</span>: <span class="number">500</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PUT: Update an existing event by ID</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">PUT</span>(<span class="params"><span class="attr">req</span>: <span class="title class_">NextRequest</span></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> body = <span class="keyword">await</span> req.<span class="title function_">json</span>();</span><br><span class="line">    <span class="keyword">const</span> &#123; id, title, description, location, date, image, isFeatured &#125; = body;</span><br><span class="line">    <span class="keyword">if</span> (!id) <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Event ID is required&#x27;</span> &#125;, &#123; <span class="attr">status</span>: <span class="number">400</span> &#125;);</span><br><span class="line">    <span class="keyword">const</span> updatedEvent = <span class="keyword">await</span> prisma.<span class="property">event</span>.<span class="title function_">update</span>(&#123;</span><br><span class="line">      <span class="attr">where</span>: &#123; id &#125;,</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        title,</span><br><span class="line">        description,</span><br><span class="line">        location,</span><br><span class="line">        <span class="attr">date</span>: date ? <span class="keyword">new</span> <span class="title class_">Date</span>(date) : <span class="literal">undefined</span>,</span><br><span class="line">        image,</span><br><span class="line">        isFeatured,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(updatedEvent);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error updating event:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Event not found or internal error&#x27;</span> &#125;, &#123; <span class="attr">status</span>: <span class="number">404</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DELETE: Delete an event by ID</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">DELETE</span>(<span class="params"><span class="attr">req</span>: <span class="title class_">NextRequest</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; searchParams &#125; = <span class="keyword">new</span> <span class="title function_">URL</span>(req.<span class="property">url</span>);</span><br><span class="line">  <span class="keyword">const</span></span><br><span class="line"></span><br><span class="line"> id = searchParams.<span class="title function_">get</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!id) <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Event ID is required&#x27;</span> &#125;, &#123; <span class="attr">status</span>: <span class="number">400</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> deletedEvent = <span class="keyword">await</span> prisma.<span class="property">event</span>.<span class="title function_">delete</span>(&#123; <span class="attr">where</span>: &#123; id &#125; &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(deletedEvent);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error deleting event:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Event not found or internal error&#x27;</span> &#125;, &#123; <span class="attr">status</span>: <span class="number">404</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Step-8-Test-the-CRUD-Operations"><a href="#Step-8-Test-the-CRUD-Operations" class="headerlink" title="Step 8: Test the CRUD Operations"></a>Step 8: Test the CRUD Operations</h2><p>You can now test the API endpoints using tools like Postman or directly in your frontend.</p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/Don-Up" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="mailto:yexudong188@gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2025 Don Ye<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>